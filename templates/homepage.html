{% extends 'base.html' %}

{% block content %}
    <div class="text-center">
      <h2 class="lead">Should I bike today?</h2>
    </div>
    <form id="search" action="/get-weather">
    <div class="row">
        <div class="col-xs-12 col-md-4 offset-md-2">
          <h3>Morning commute time</h3>
          <select name="morning" class="form-control">
            <option value="4">4:00 am</option>
            <option value="5">5:00 am</option>
            <option value="6">6:00 am</option>
            <option value="7">7:00 am</option>
            <option value="8">8:00 am</option>
            <option value="9" selected="selected">9:00 am</option>
            <option value="10">10:00 am</option>
            <option value="11">11:00 am</option>
            <option value="12">Noon</option>
          </select>
        </div>
        <div class="col-xs-12 col-md-4">
          <h3>Evening commute</h3>
          <select name="evening" class="form-control">
            <option value="3">3:00 pm</option>
            <option value="4">4:00 pm</option>
            <option value="5">5:00 pm</option>
            <option value="6" selected="selected">6:00 pm</option>
            <option value="7">7:00 pm</option>
            <option value="8">8:00 pm</option>
            <option value="9">9:00 pm</option>
            <option value="10">10:00 pm</option>
            <option value="11">11:00 pm</option>
            <option value="12">Noon</option>
          </select>
        </div>
      </div>
        <input type="text" id="lat" name="lat" hidden>
        <input type="text" id="lon" name="lon" hidden>
        <p class="waiting">Getting your location...</p>
        <button type="submit" class="btn btn-primary" name="button" disabled>Submit</button>

  </form>
    <script
        src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript">
    function getLocation() {
      if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        $("#lat").val("37.7749");
        $("#lon").val("-122.4194");
        $("button[type='submit']").removeAttr('disabled')
      }
    }
    function showPosition(position) {
        $("#lat").val(position.coords.latitude);
        $("#lon").val(position.coords.longitude);
        $('.waiting').remove()
        $("button[type='submit']").removeAttr('disabled')
    }
    getLocation();


    // $("#search").on("submit", function(evt){
    //   evt.preventDefault()
    //   if ($("#lat").val() && $("#lon").val()) {
    //     $("#search").submit()
    //   }
    //   else {
    //     alert("No position values")
    //   }
    // })
    </script>

{% endblock %}
